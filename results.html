<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Suggestions</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="results-container welcome-container">
            <h1>Food Suggestions</h1>
            <div id="food-results">
                <!-- Food suggestions will be displayed here -->
            </div>

            <!-- Add a search bar to search meals by name -->
            <div class="search-container">
                <input type="text" id="meal-search" placeholder="Search for a meal...">
                <button onclick="searchMeal()">Search Meal</button>
            </div>

            <!-- View all meals button -->
            <button onclick="viewAllMeals()">View All Meals</button>

            <div id="meal-info">
                <!-- Meal information will be displayed here after searching -->
            </div>

            <button onclick="goBack()">Go Back</button>
        </div>
    </div>

    <script>
        // Function to get query parameter by name
        function getQueryParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Function to display the food suggestions on the page
        function displayResults() {
            const resultsString = getQueryParameter('foodSuggestions');
            const foodResultsContainer = document.getElementById('food-results');

            if (resultsString) {
                const results = decodeURIComponent(resultsString).split(',');

                if (results.length > 0) {
                    foodResultsContainer.innerHTML = `
                        <h3>Here are your food suggestions:</h3>
                        <ul>${results.map(item => `<li>${item}</li>`).join('')}</ul>
                    `;
                } else {
                    foodResultsContainer.innerHTML = '<p>No valid suggestions found.</p>';
                }
            } else {
                foodResultsContainer.innerHTML = '<p>No suggestions found.</p>';
            }
        }

        // Function to search meal by name using the MealDB API
        function searchMeal() {
            const mealName = document.getElementById('meal-search').value;
            if (mealName) {
                fetch(`https://www.themealdb.com/api/json/v1/1/search.php?s=${mealName}`)
                    .then(response => response.json())
                    .then(data => {
                        const mealInfoContainer = document.getElementById('meal-info');
                        if (data.meals) {
                            const meal = data.meals[0];
                            mealInfoContainer.innerHTML = `
                                <h3>${meal.strMeal}</h3>
                                <img src="${meal.strMealThumb}" alt="${meal.strMeal}" style="width:200px;">
                                <p><strong>Category:</strong> ${meal.strCategory}</p>
                                <p><strong>Area:</strong> ${meal.strArea}</p>
                                <p><strong>Instructions:</strong> ${meal.strInstructions}</p>
                                <h4>Ingredients:</h4>
                                <ul>
                                    ${Object.keys(meal).filter(key => key.startsWith('strIngredient') && meal[key]).map(key => `<li>${meal[key]}</li>`).join('')}
                                </ul>
                            `;
                        } else {
                            mealInfoContainer.innerHTML = '<p>No meal found with that name.</p>';
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching meal data:', error);
                        document.getElementById('meal-info').innerHTML = '<p>Error fetching meal data. Please try again later.</p>';
                    });
            } else {
                alert('Please enter a meal name.');
            }
        }

        // Function to view all meals
        function viewAllMeals() {
            fetch('https://www.themealdb.com/api/json/v1/1/search.php?f=a')  // Fetch meals starting with 'A'
                .then(response => response.json())
                .then(data => {
                    const foodResultsContainer = document.getElementById('food-results');
                    const meals = data.meals;

                    if (meals) {
                        foodResultsContainer.innerHTML = `
                            <h3>All Meals (starting with "A"):</h3>
                            <ul>
                                ${meals.map(meal => `<li>${meal.strMeal}</li>`).join('')}
                            </ul>
                        `;
                    } else {
                        foodResultsContainer.innerHTML = '<p>No meals found.</p>';
                    }
                })
                .catch(error => {
                    console.error('Error fetching all meals:', error);
                    document.getElementById('food-results').innerHTML = '<p>Error fetching meals. Please try again later.</p>';
                });
        }

        // Function to go back to the main page
        function goBack() {
            window.location.href = 'index.html';
        }

        // Display the food suggestions when the page loads
        window.onload = displayResults;
    </script>
</body>
</html>
